# ì—‘ì…€ ê¸°ë°˜ ìë™í™” ì„¤ê³„

## ê°œìš”

**í•µì‹¬ ì•„ì´ë””ì–´**: ìŠ¤í”„ë ˆë“œì—ì„œ ê°’ì„ ì½ëŠ” ëŒ€ì‹ , ë¯¸ë¦¬ ì¤€ë¹„í•œ ì‚¬ì› ì •ë³´ ì—‘ì…€ì„ í™œìš©í•˜ì—¬ ìˆœì„œëŒ€ë¡œ ì²˜ë¦¬

## ë¬¸ì œ ìƒí™©

### í˜„ì¬ ì œì•½ì‚¬í•­
1. **ë°±ê·¸ë¼ìš´ë“œ ì½ê¸° ë¶ˆê°€ëŠ¥** (Attempts 54-85, 32íšŒ ì‹œë„ ì‹¤íŒ¨)
   - fpUSpread80ì€ í‘œì¤€ ìë™í™” API ë¯¸ì§€ì›
   - SendMessage, UIAutomation, COM ëª¨ë‘ ì‹¤íŒ¨

2. **í¬ê·¸ë¼ìš´ë“œ ë°©ì‹ì˜ í•œê³„**
   - ê° ì‚¬ì›ë§ˆë‹¤ í´ë¦­ â†’ ë³µì‚¬ í•„ìš”
   - ì‚¬ìš©ìê°€ ë‹¤ë¥¸ ì‘ì—… ë¶ˆê°€
   - ëŠë¦° ì†ë„

## í•´ê²° ë°©ì•ˆ: ì—‘ì…€ ê¸°ë°˜ ìë™í™”

### í•µì‹¬ ë¡œì§

```
1. ì‚¬ì› ì •ë³´ ì—‘ì…€ íŒŒì¼ ì¤€ë¹„
   - ì‚¬ë²ˆ, ì´ë¦„, ë¶€ì„œ ë“± ê¸°ë³¸ ì •ë³´
   - ERP ìŠ¤í”„ë ˆë“œì™€ ë™ì¼í•œ ìˆœì„œë¡œ ì •ë ¬

2. ì²« ë²ˆì§¸ ì‚¬ì›ë§Œ í™•ì¸ (ë™ê¸°í™”)
   - ìŠ¤í”„ë ˆë“œ ì²« í–‰ í´ë¦­
   - ì‚¬ë²ˆ ë³µì‚¬ (í¬ê·¸ë¼ìš´ë“œë¡œ 1íšŒë§Œ)
   - ì—‘ì…€ì—ì„œ í•´ë‹¹ ì‚¬ë²ˆ ì°¾ê¸°
   - ì‹œì‘ ì¸ë±ìŠ¤ í™•ì¸

3. ìˆœì„œëŒ€ë¡œ ìë™ ì²˜ë¦¬
   - ì—‘ì…€ ë°ì´í„°ë¥¼ ìˆœì„œëŒ€ë¡œ ì½ìŒ
   - ìŠ¤í”„ë ˆë“œëŠ” í™”ì‚´í‘œ í‚¤ë¡œ ì´ë™ë§Œ
   - ê° ì‚¬ì›ì˜ ë¶€ì–‘ê°€ì¡± ë°ì´í„° ì…ë ¥
```

### ì‘ë™ ë°©ì‹

#### ê¸°ì¡´ ë°©ì‹ (í¬ê·¸ë¼ìš´ë“œ í•„ìš”)
```python
for row in range(row_count):
    # ë§¤ë²ˆ í´ë¦­ í•„ìš”
    spread.click_cell(row, 0)
    spread.type_keys("^c")
    empno = pyperclip.paste()  # ì‚¬ë²ˆ ì½ê¸°

    # CSVì—ì„œ ë§¤ì¹­
    dependents = csv_data[csv_data['ì‚¬ë²ˆ'] == empno]

    # ì…ë ¥
    input_dependents(dependents)
```

#### ìƒˆë¡œìš´ ë°©ì‹ (ì—‘ì…€ ê¸°ë°˜)
```python
# 1. ì—‘ì…€ íŒŒì¼ ë¡œë“œ
employees = pd.read_excel("ì‚¬ì›ì •ë³´.xlsx")
dependents_data = pd.read_excel("ë¶€ì–‘ê°€ì¡±ì •ë³´.xlsx")

# 2. ì²« ë²ˆì§¸ ì‚¬ì›ìœ¼ë¡œ ë™ê¸°í™” (1íšŒë§Œ)
spread.click_cell(0, 0)
spread.type_keys("^c")
first_empno = pyperclip.paste()

# ì—‘ì…€ì—ì„œ ì‹œì‘ ìœ„ì¹˜ ì°¾ê¸°
start_index = employees[employees['ì‚¬ë²ˆ'] == first_empno].index[0]

# 3. ìˆœì„œëŒ€ë¡œ ì²˜ë¦¬ (í´ë¦­/ë³µì‚¬ ë¶ˆí•„ìš”!)
for i, emp in enumerate(employees.iloc[start_index:]):
    empno = emp['ì‚¬ë²ˆ']

    # í•´ë‹¹ ì‚¬ì›ì˜ ë¶€ì–‘ê°€ì¡± ë°ì´í„°
    deps = dependents_data[dependents_data['ì‚¬ë²ˆ'] == empno]

    # ë¶€ì–‘ê°€ì¡± ì…ë ¥
    input_dependents(deps)

    # ë‹¤ìŒ í–‰ìœ¼ë¡œ ì´ë™ (í™”ì‚´í‘œ í‚¤ë§Œ)
    spread.type_keys("{DOWN}")
```

## ì¥ì 

### 1. ë°±ê·¸ë¼ìš´ë“œ ë¬¸ì œ í•´ê²° âœ…
- ìŠ¤í”„ë ˆë“œì—ì„œ ê°’ì„ ì½ì§€ ì•ŠìŒ
- ì—‘ì…€ ë°ì´í„°ë¥¼ ìˆœì„œëŒ€ë¡œ ì½ê¸°ë§Œ í•¨
- ë°±ê·¸ë¼ìš´ë“œ/í¬ê·¸ë¼ìš´ë“œ ë¬´ê´€

### 2. ì†ë„ í–¥ìƒ âš¡
```
ê¸°ì¡´: í´ë¦­(0.5s) + ë³µì‚¬(0.3s) + ë§¤ì¹­(0.1s) = 0.9s/ì‚¬ì›
ìƒˆë¡œìš´: ì´ë™(0.1s) + ë§¤ì¹­(0.1s) = 0.2s/ì‚¬ì›

100ëª… ê¸°ì¤€:
- ê¸°ì¡´: 90ì´ˆ
- ìƒˆë¡œìš´: 20ì´ˆ
â†’ 70ì´ˆ ë‹¨ì¶• (78% í–¥ìƒ)
```

### 3. ì•ˆì •ì„± í–¥ìƒ ğŸ›¡ï¸
- í´ë¦½ë³´ë“œ ì˜ì¡´ë„ ê°ì†Œ
- ë³µì‚¬ ì‹¤íŒ¨ ë¦¬ìŠ¤í¬ ì œê±°
- ê°„ë‹¨í•œ ë¡œì§

### 4. ìœ ì—°ì„± ğŸ“Š
- ì—‘ì…€ì—ì„œ ë°ì´í„° ì „ì²˜ë¦¬ ê°€ëŠ¥
- í•„í„°ë§, ì •ë ¬ ë“± ììœ ë¡­ê²Œ ì¡°ì‘
- ë‹¤ì–‘í•œ í˜•ì‹ ì§€ì› (xlsx, csv)

## ì—‘ì…€ íŒŒì¼ êµ¬ì¡°

### 1. ì‚¬ì›ì •ë³´.xlsx

| ì‚¬ë²ˆ | ì´ë¦„ | ë¶€ì„œ | ì§ê¸‰ |
|------|------|------|------|
| 0000000001 | í™ê¸¸ë™ | ê°œë°œíŒ€ | ëŒ€ë¦¬ |
| 0000000002 | ê¹€ì² ìˆ˜ | ì˜ì—…íŒ€ | ê³¼ì¥ |
| ... | ... | ... | ... |

**í•„ìˆ˜ ì»¬ëŸ¼**:
- `ì‚¬ë²ˆ`: ê³ ìœ  ì‹ë³„ì

**ì„ íƒ ì»¬ëŸ¼**:
- ì´ë¦„, ë¶€ì„œ ë“± (ê²€ì¦ìš©)

### 2. ë¶€ì–‘ê°€ì¡±ì •ë³´.xlsx

| ì‚¬ë²ˆ | ì´ë¦„ | ê´€ê³„ | ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸ |
|------|------|------|--------------|
| 0000000001 | í™ê¸¸ë™ | ë³¸ì¸ | 123456-1234567 |
| 0000000001 | ê¹€ì˜í¬ | ë°°ìš°ì | 123456-2234567 |
| 0000000002 | ê¹€ì² ìˆ˜ | ë³¸ì¸ | 234567-1345678 |
| ... | ... | ... | ... |

**í•„ìˆ˜ ì»¬ëŸ¼**:
- `ì‚¬ë²ˆ`: ì™¸ë˜ í‚¤ (ì‚¬ì›ì •ë³´ì™€ ë§¤ì¹­)
- `ì´ë¦„`, `ê´€ê³„`, `ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸`: ì…ë ¥í•  ë°ì´í„°

## êµ¬í˜„ ë‹¨ê³„

### Phase 1: ì—‘ì…€ ë¡œë” êµ¬í˜„
```python
# excel_loader.py
import pandas as pd

def load_employees(filepath):
    """ì‚¬ì› ì •ë³´ ë¡œë“œ"""
    df = pd.read_excel(filepath)

    # í•„ìˆ˜ ì»¬ëŸ¼ ê²€ì¦
    required = ['ì‚¬ë²ˆ']
    if not all(col in df.columns for col in required):
        raise ValueError(f"í•„ìˆ˜ ì»¬ëŸ¼ ëˆ„ë½: {required}")

    return df

def load_dependents(filepath):
    """ë¶€ì–‘ê°€ì¡± ì •ë³´ ë¡œë“œ"""
    df = pd.read_excel(filepath)

    # í•„ìˆ˜ ì»¬ëŸ¼ ê²€ì¦
    required = ['ì‚¬ë²ˆ', 'ì´ë¦„', 'ê´€ê³„', 'ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸']
    if not all(col in df.columns for col in required):
        raise ValueError(f"í•„ìˆ˜ ì»¬ëŸ¼ ëˆ„ë½: {required}")

    return df

def get_dependents_for_employee(dependents_df, empno):
    """íŠ¹ì • ì‚¬ì›ì˜ ë¶€ì–‘ê°€ì¡± ì¡°íšŒ"""
    return dependents_df[dependents_df['ì‚¬ë²ˆ'] == empno]
```

### Phase 2: ë™ê¸°í™” ë¡œì§
```python
def sync_with_spread(spread, employees_df):
    """
    ìŠ¤í”„ë ˆë“œì˜ ì²« ë²ˆì§¸ ì‚¬ì›ê³¼ ì—‘ì…€ ë°ì´í„° ë™ê¸°í™”

    Returns:
        start_index: ì—‘ì…€ì—ì„œ ì‹œì‘í•  ì¸ë±ìŠ¤
    """
    # ì²« í–‰ í´ë¦­
    spread.click_cell(0, 0)
    time.sleep(0.3)

    # ì‚¬ë²ˆ ë³µì‚¬
    pyperclip.copy("")
    spread.type_keys("^c")
    time.sleep(0.3)

    first_empno = pyperclip.paste()
    print(f"ì²« ë²ˆì§¸ ì‚¬ë²ˆ: {first_empno}")

    # ì—‘ì…€ì—ì„œ ì°¾ê¸°
    matches = employees_df[employees_df['ì‚¬ë²ˆ'] == first_empno]

    if len(matches) == 0:
        raise ValueError(f"ì—‘ì…€ì—ì„œ ì‚¬ë²ˆ {first_empno}ì„(ë¥¼) ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!")

    start_index = matches.index[0]
    print(f"ì‹œì‘ ì¸ë±ìŠ¤: {start_index}")

    return start_index
```

### Phase 3: ë©”ì¸ ë£¨í”„
```python
def process_employees(spread, employees_df, dependents_df, start_index):
    """
    ì‚¬ì› ì •ë³´ë¥¼ ìˆœì„œëŒ€ë¡œ ì²˜ë¦¬
    """
    total = len(employees_df) - start_index
    print(f"ì²˜ë¦¬í•  ì‚¬ì› ìˆ˜: {total}ëª…")

    for i, (idx, emp) in enumerate(employees_df.iloc[start_index:].iterrows()):
        empno = emp['ì‚¬ë²ˆ']
        print(f"\n[{i+1}/{total}] ì‚¬ë²ˆ: {empno}")

        # ë¶€ì–‘ê°€ì¡± ì¡°íšŒ
        deps = get_dependents_for_employee(dependents_df, empno)
        print(f"  ë¶€ì–‘ê°€ì¡±: {len(deps)}ëª…")

        if len(deps) > 0:
            # ë¶€ì–‘ê°€ì¡± ì…ë ¥
            input_dependents(spread, deps)
        else:
            print("  (ë¶€ì–‘ê°€ì¡± ì—†ìŒ)")

        # ë‹¤ìŒ í–‰ìœ¼ë¡œ ì´ë™
        if i < total - 1:  # ë§ˆì§€ë§‰ í–‰ì´ ì•„ë‹ˆë©´
            spread.type_keys("{DOWN}")
            time.sleep(0.1)

        # ì§„í–‰ë¥  í‘œì‹œ
        progress = (i + 1) / total * 100
        print(f"  ì§„í–‰ë¥ : {progress:.1f}%")
```

## ì‹œë‚˜ë¦¬ì˜¤ ë¹„êµ

### ì‹œë‚˜ë¦¬ì˜¤ A: ì „ì²´ ì¼ì¹˜
```
ìŠ¤í”„ë ˆë“œ: [ì‚¬ì›1, ì‚¬ì›2, ì‚¬ì›3, ì‚¬ì›4, ì‚¬ì›5]
ì—‘ì…€:     [ì‚¬ì›1, ì‚¬ì›2, ì‚¬ì›3, ì‚¬ì›4, ì‚¬ì›5]

â†’ ì²« í–‰ í™•ì¸ í›„ ìˆœì„œëŒ€ë¡œ ì²˜ë¦¬
```

### ì‹œë‚˜ë¦¬ì˜¤ B: ë¶€ë¶„ ì¼ì¹˜
```
ìŠ¤í”„ë ˆë“œ: [ì‚¬ì›3, ì‚¬ì›4, ì‚¬ì›5]
ì—‘ì…€:     [ì‚¬ì›1, ì‚¬ì›2, ì‚¬ì›3, ì‚¬ì›4, ì‚¬ì›5]

â†’ ì²« í–‰(ì‚¬ì›3) í™•ì¸
â†’ ì—‘ì…€ ì¸ë±ìŠ¤ 2ë¶€í„° ì‹œì‘
```

### ì‹œë‚˜ë¦¬ì˜¤ C: ìˆœì„œ ë¶ˆì¼ì¹˜ âš ï¸
```
ìŠ¤í”„ë ˆë“œ: [ì‚¬ì›1, ì‚¬ì›3, ì‚¬ì›2]
ì—‘ì…€:     [ì‚¬ì›1, ì‚¬ì›2, ì‚¬ì›3]

â†’ ë¬¸ì œ ë°œìƒ! ë‘ ë²ˆì§¸ í–‰ë¶€í„° ë¶ˆì¼ì¹˜
```

**í•´ê²°ì±…**:
1. **ê¶Œì¥**: ì—‘ì…€ì„ ìŠ¤í”„ë ˆë“œ ìˆœì„œì™€ ë™ì¼í•˜ê²Œ ì •ë ¬
2. ê° í–‰ë§ˆë‹¤ ì‚¬ë²ˆ í™•ì¸ (ëŠë¦¬ì§€ë§Œ ì•ˆì „)

## ì—ëŸ¬ ì²˜ë¦¬

### 1. ì²« í–‰ ë™ê¸°í™” ì‹¤íŒ¨
```python
try:
    start_index = sync_with_spread(spread, employees_df)
except ValueError as e:
    print(f"âŒ ë™ê¸°í™” ì‹¤íŒ¨: {e}")
    print("ì—‘ì…€ íŒŒì¼ì— í•´ë‹¹ ì‚¬ë²ˆì´ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.")
    return
```

### 2. ì¤‘ê°„ì— ë¶ˆì¼ì¹˜ ë°œê²¬
```python
# ì£¼ê¸°ì  ê²€ì¦ (10ëª…ë§ˆë‹¤)
if i % 10 == 0:
    # í˜„ì¬ ì…€ ì‚¬ë²ˆ í™•ì¸
    spread.type_keys("^c")
    current_empno = pyperclip.paste()

    if current_empno != emp['ì‚¬ë²ˆ']:
        print(f"âš ï¸  ê²½ê³ : ìˆœì„œ ë¶ˆì¼ì¹˜!")
        print(f"  ì˜ˆìƒ: {emp['ì‚¬ë²ˆ']}")
        print(f"  ì‹¤ì œ: {current_empno}")
        # ì‚¬ìš©ìì—ê²Œ í™•ì¸ ìš”ì²­
        response = input("ê³„ì† ì§„í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (y/n): ")
        if response.lower() != 'y':
            return
```

### 3. ë¶€ì–‘ê°€ì¡± ì—†ìŒ
```python
deps = get_dependents_for_employee(dependents_df, empno)

if len(deps) == 0:
    print(f"  ë¶€ì–‘ê°€ì¡± ë°ì´í„° ì—†ìŒ - ê±´ë„ˆëœ€")
    # ë˜ëŠ” ê²½ê³  í‘œì‹œ
    # warnings.append(f"ì‚¬ë²ˆ {empno}: ë¶€ì–‘ê°€ì¡± ë°ì´í„° ì—†ìŒ")
```

## ì„±ëŠ¥ ì˜ˆì¸¡

### 100ëª… ì‚¬ì› ê¸°ì¤€

**ê¸°ì¡´ ë°©ì‹ (í¬ê·¸ë¼ìš´ë“œ + ë³µì‚¬)**:
```
- í´ë¦­: 0.5s
- ë³µì‚¬: 0.3s
- ë§¤ì¹­: 0.1s
- ì…ë ¥: 2.0s (í‰ê·  2ëª…)
= 2.9s/ì‚¬ì›

100ëª… Ã— 2.9s = 290ì´ˆ (ì•½ 5ë¶„)
```

**ìƒˆë¡œìš´ ë°©ì‹ (ì—‘ì…€ ê¸°ë°˜)**:
```
- ì´ë™: 0.1s
- ë§¤ì¹­: 0.05s
- ì…ë ¥: 2.0s (í‰ê·  2ëª…)
= 2.15s/ì‚¬ì›

100ëª… Ã— 2.15s = 215ì´ˆ (ì•½ 3.5ë¶„)

ì ˆê°: 75ì´ˆ (26% í–¥ìƒ)
```

**ì¶”ê°€ ìµœì í™” ì‹œ**:
- ì…ë ¥ ì§€ì—° ì‹œê°„ ë‹¨ì¶•
- ë³‘ë ¬ ì²˜ë¦¬ (ê°€ëŠ¥í•œ ê²½ìš°)
â†’ 50% ì´ìƒ í–¥ìƒ ê°€ëŠ¥

## êµ¬í˜„ íŒŒì¼ êµ¬ì¡°

```
newgen-erp-macro/
â”œâ”€â”€ data/                        # ë°ì´í„° íŒŒì¼
â”‚   â”œâ”€â”€ ì‚¬ì›ì •ë³´.xlsx
â”‚   â”œâ”€â”€ ë¶€ì–‘ê°€ì¡±ì •ë³´.xlsx
â”‚   â””â”€â”€ ì‚¬ì›ì •ë³´.example.xlsx   # ì˜ˆì œ íŒŒì¼
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ excel_loader.py          # ì—‘ì…€ ë¡œë”
â”‚   â”œâ”€â”€ sync.py                  # ë™ê¸°í™” ë¡œì§
â”‚   â””â”€â”€ processor.py             # ë©”ì¸ ì²˜ë¦¬ ë¡œì§
â”‚
â””â”€â”€ bulk_dependent_input.py      # ë©”ì¸ ìŠ¤í¬ë¦½íŠ¸
```

## ë‹¤ìŒ ë‹¨ê³„

1. âœ… ì„¤ê³„ ë¬¸ì„œ ì‘ì„±
2. â¬œ `excel_loader.py` êµ¬í˜„
3. â¬œ `sync.py` êµ¬í˜„
4. â¬œ `processor.py` êµ¬í˜„
5. â¬œ í†µí•© í…ŒìŠ¤íŠ¸
6. â¬œ ì‹¤ì œ ë°ì´í„°ë¡œ ê²€ì¦

---

**ì‘ì„±ì¼**: 2025-10-31
**ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-10-31
**ì œì•ˆì**: ì‚¬ìš©ì
**ìƒíƒœ**: ì„¤ê³„ ë‹¨ê³„
